function X509(r){var k=ASN1HEX,o=k.getChildIdx,h=k.getV,u=k.dump,g=k.parse,b=k.getTLV,c=k.getVbyList,l=k.getVbyListEx,a=k.getTLVbyList,m=k.getTLVbyListEx,i=k.getIdxbyList,e=k.getIdxbyListEx,j=k.getVidx,t=k.getInt,q=k.oidname,n=k.hextooidstr,d=X509,s=pemtohex,f;try{f=KJUR.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(p){}this.HEX2STAG={"0c":"utf8","13":"prn","16":"ia5","1a":"vis","1e":"bmp"};this.hex=null;this.version=0;this.foffset=0;this.aExtInfo=null;this.getVersion=function(){if(this.hex===null||this.version!==0){return this.version}var w=a(this.hex,0,[0,0]);if(w.substr(0,2)=="a0"){var x=a(w,0,[0]);var v=t(x,0);if(v<0||2<v){throw new Error("malformed version field")}this.version=v+1;return this.version}else{this.version=1;this.foffset=-1;return 1}};this.getSerialNumberHex=function(){return l(this.hex,0,[0,0],"02")};this.getSignatureAlgorithmField=function(){var v=m(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(v)};this.getAlgorithmIdentifierName=function(v){for(var w in f){if(v===f[w]){return w}}return q(l(v,0,[0],"06"))};this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())};this.getIssuerHex=function(){return a(this.hex,0,[0,3+this.foffset],"30")};this.getIssuerString=function(){var v=this.getIssuer();return v.str};this.getSubject=function(){return this.getX500Name(this.getSubjectHex())};this.getSubjectHex=function(){return a(this.hex,0,[0,5+this.foffset],"30")};this.getSubjectString=function(){var v=this.getSubject();return v.str};this.getNotBefore=function(){var v=c(this.hex,0,[0,4+this.foffset,0]);v=v.replace(/(..)/g,"%$1");v=decodeURIComponent(v);return v};this.getNotAfter=function(){var v=c(this.hex,0,[0,4+this.foffset,1]);v=v.replace(/(..)/g,"%$1");v=decodeURIComponent(v);return v};this.getPublicKeyHex=function(){return k.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKeyIdx=function(){return i(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKeyContentIdx=function(){var v=this.getPublicKeyIdx();return i(this.hex,v,[1,0],"30")};this.getPublicKey=function(){return KEYUTIL.getKey(this.getPublicKeyHex(),null,"pkcs8pub")};this.getSignatureAlgorithmName=function(){var v=a(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(v)};this.getSignatureValueHex=function(){return c(this.hex,0,[2],"03",true)};this.verifySignature=function(x){var y=this.getSignatureAlgorithmField();var v=this.getSignatureValueHex();var w=a(this.hex,0,[0],"30");var z=new KJUR.crypto.Signature({alg:y});z.init(x);z.updateHex(w);return z.verify(v)};this.parseExt=function(E){var x,v,z;if(E===undefined){z=this.hex;if(this.version!==3){return -1}x=i(z,0,[0,7,0],"30");v=o(z,x)}else{z=pemtohex(E);var A=i(z,0,[0,3,0,0],"06");if(h(z,A)!="2a864886f70d01090e"){this.aExtInfo=new Array();return}x=i(z,0,[0,3,0,1,0],"30");v=o(z,x);this.hex=z}this.aExtInfo=new Array();for(var y=0;y<v.length;y++){var C={};C.critical=false;var B=o(z,v[y]);var w=0;if(B.length===3){C.critical=true;w=1}C.oid=k.hextooidstr(c(z,v[y],[0],"06"));var D=i(z,v[y],[1+w]);C.vidx=j(z,D);this.aExtInfo.push(C)}};this.getExtInfo=function(x){var v=this.aExtInfo;var y=x;if(!x.match(/^[0-9.]+$/)){y=KJUR.asn1.x509.OID.name2oid(x)}if(y===""){return undefined}for(var w=0;w<v.length;w++){if(v[w].oid===y){return v[w]}}return undefined};this.getExtBasicConstraints=function(w,A){if(w===undefined&&A===undefined){var y=this.getExtInfo("basicConstraints");if(y===undefined){return undefined}w=b(this.hex,y.vidx);A=y.critical}var v={extname:"basicConstraints"};if(A){v.critical=true}if(w==="3000"){return v}if(w==="30030101ff"){v.cA=true;return v}if(w.substr(0,12)==="30060101ff02"){var z=h(w,10);var x=parseInt(z,16);v.cA=true;v.pathLen=x;return v}throw new Error("hExtV parse error: "+w)};this.getExtKeyUsage=function(w,y){if(w===undefined&&y===undefined){var x=this.getExtInfo("keyUsage");if(x===undefined){return undefined}w=b(this.hex,x.vidx);y=x.critical}var v={extname:"keyUsage"};if(y){v.critical=true}v.names=this.getExtKeyUsageString(w).split(",");return v};this.getExtKeyUsageBin=function(w){if(w===undefined){var x=this.getExtInfo("keyUsage");if(x===undefined){return""}w=b(this.hex,x.vidx)}if(w.length!=8&&w.length!=10){throw new Error("malformed key usage value: "+w)}var v="000000000000000"+parseInt(w.substr(6),16).toString(2);if(w.length==8){v=v.slice(-8)}if(w.length==10){v=v.slice(-16)}v=v.replace(/0+$/,"");if(v==""){v="0"}return v};this.getExtKeyUsageString=function(x){var y=this.getExtKeyUsageBin(x);var v=new Array();for(var w=0;w<y.length;w++){if(y.substr(w,1)=="1"){v.push(X509.KEYUSAGE_NAME[w])}}return v.join(",")};this.getExtSubjectKeyIdentifier=function(x,z){if(x===undefined&&z===undefined){var y=this.getExtInfo("subjectKeyIdentifier");if(y===undefined){return undefined}x=b(this.hex,y.vidx);z=y.critical}var v={extname:"subjectKeyIdentifier"};if(z){v.critical=true}var w=h(x,0);v.kid={hex:w};return v};this.getExtAuthorityKeyIdentifier=function(B,z){if(B===undefined&&z===undefined){var v=this.getExtInfo("authorityKeyIdentifier");if(v===undefined){return undefined}B=b(this.hex,v.vidx);z=v.critical}var C={extname:"authorityKeyIdentifier"};if(z){C.critical=true}var A=o(B,0);for(var w=0;w<A.length;w++){var D=B.substr(A[w],2);if(D==="80"){C.kid={hex:h(B,A[w])}}if(D==="a1"){var y=b(B,A[w]);var x=this.getGeneralNames(y);C.issuer=x[0]["dn"]}if(D==="82"){C.sn={hex:h(B,A[w])}}}return C};this.getExtExtKeyUsage=function(y,A){if(y===undefined&&A===undefined){var z=this.getExtInfo("extKeyUsage");if(z===undefined){return undefined}y=b(this.hex,z.vidx);A=z.critical}var v={extname:"extKeyUsage",array:[]};if(A){v.critical=true}var w=o(y,0);for(var x=0;x<w.length;x++){v.array.push(q(h(y,w[x])))}return v};this.getExtExtKeyUsageName=function(){var z=this.getExtInfo("extKeyUsage");if(z===undefined){return z}var v=new Array();var y=b(this.hex,z.vidx);if(y===""){return v}var w=o(y,0);for(var x=0;x<w.length;x++){v.push(q(h(y,w[x])))}return v};this.getExtSubjectAltName=function(w,y){if(w===undefined&&y===undefined){var x=this.getExtInfo("subjectAltName");if(x===undefined){return undefined}w=b(this.hex,x.vidx);y=x.critical}var v={extname:"subjectAltName",array:[]};if(y){v.critical=true}v.array=this.getGeneralNames(w);return v};this.getExtIssuerAltName=function(w,y){if(w===undefined&&y===undefined){var x=this.getExtInfo("issuerAltName");if(x===undefined){return undefined}w=b(this.hex,x.vidx);y=x.critical}var v={extname:"issuerAltName",array:[]};if(y){v.critical=true}v.array=this.getGeneralNames(w);return v};this.getGeneralNames=function(z){var x=o(z,0);var v=[];for(var y=0;y<x.length;y++){var w=this.getGeneralName(b(z,x[y]));if(w!==undefined){v.push(w)}}return v};this.getGeneralName=function(w){var v=w.substr(0,2);var y=h(w,0);var x=hextorstr(y);if(v=="81"){return{rfc822:x}}if(v=="82"){return{dns:x}}if(v=="86"){return{uri:x}}if(v=="87"){return{ip:hextoip(y)}}if(v=="a4"){return{dn:this.getX500Name(y)}}if(v=="a0"){return{other:this.getOtherName(w)}}return undefined};this.getExtSubjectAltName2=function(){var z,C,B;var A=this.getExtInfo("subjectAltName");if(A===undefined){return A}var v=new Array();var y=b(this.hex,A.vidx);var w=o(y,0);for(var x=0;x<w.length;x++){B=y.substr(w[x],2);z=h(y,w[x]);if(B==="81"){C=hextoutf8(z);v.push(["MAIL",C])}if(B==="82"){C=hextoutf8(z);v.push(["DNS",C])}if(B==="84"){C=X509.hex2dn(z,0);v.push(["DN",C])}if(B==="86"){C=hextoutf8(z);v.push(["URI",C])}if(B==="87"){C=hextoip(z);v.push(["IP",C])}}return v};this.getExtCRLDistributionPoints=function(z,B){if(z===undefined&&B===undefined){var A=this.getExtInfo("cRLDistributionPoints");if(A===undefined){return undefined}z=b(this.hex,A.vidx);B=A.critical}var w={extname:"cRLDistributionPoints",array:[]};if(B){w.critical=true}var x=o(z,0);for(var y=0;y<x.length;y++){var v=b(z,x[y]);w.array.push(this.getDistributionPoint(v))}return w};this.getDistributionPoint=function(A){var x={};var y=o(A,0);for(var z=0;z<y.length;z++){var w=A.substr(y[z],2);var v=b(A,y[z]);if(w=="a0"){x.dpname=this.getDistributionPointName(v)}}return x};this.getDistributionPointName=function(A){var x={};var y=o(A,0);for(var z=0;z<y.length;z++){var w=A.substr(y[z],2);var v=b(A,y[z]);if(w=="a0"){x.full=this.getGeneralNames(v)}}return x};this.getExtCRLDistributionPointsURI=function(){var A=this.getExtInfo("cRLDistributionPoints");if(A===undefined){return A}var v=new Array();var w=o(this.hex,A.vidx);for(var y=0;y<w.length;y++){try{var B=c(this.hex,w[y],[0,0,0],"86");var z=hextoutf8(B);v.push(z)}catch(x){}}return v};this.getExtAIAInfo=function(){var z=this.getExtInfo("authorityInfoAccess");if(z===undefined){return z}var v={ocsp:[],caissuer:[]};var w=o(this.hex,z.vidx);for(var x=0;x<w.length;x++){var A=c(this.hex,w[x],[0],"06");var y=c(this.hex,w[x],[1],"86");if(A==="2b06010505073001"){v.ocsp.push(hextoutf8(y))}if(A==="2b06010505073002"){v.caissuer.push(hextoutf8(y))}}return v};this.getExtAuthorityInfoAccess=function(C,A){if(C===undefined&&A===undefined){var v=this.getExtInfo("authorityInfoAccess");if(v===undefined){return undefined}C=b(this.hex,v.vidx);A=v.critical}var D={extname:"authorityInfoAccess",array:[]};if(A){D.critical=true}var B=o(C,0);for(var w=0;w<B.length;w++){var z=l(C,B[w],[0],"06");var x=c(C,B[w],[1],"86");var y=hextoutf8(x);if(z=="2b06010505073001"){D.array.push({ocsp:y})}else{if(z=="2b06010505073002"){D.array.push({caissuer:y})}else{throw new Error("unknown method: "+z)}}}return D};this.getExtCertificatePolicies=function(z,C){if(z===undefined&&C===undefined){var B=this.getExtInfo("certificatePolicies");if(B===undefined){return undefined}z=b(this.hex,B.vidx);C=B.critical}var v={extname:"certificatePolicies",array:[]};if(C){v.critical=true}var w=o(z,0);for(var x=0;x<w.length;x++){var A=b(z,w[x]);var y=this.getPolicyInformation(A);v.array.push(y)}return v};this.getPolicyInformation=function(z){var v={};var B=c(z,0,[0],"06");v.policyoid=q(B);var C=e(z,0,[1],"30");if(C!=-1){v.array=[];var w=o(z,C);for(var x=0;x<w.length;x++){var A=b(z,w[x]);var y=this.getPolicyQualifierInfo(A);v.array.push(y)}}return v};this.getOtherName=function(x){var v={};var w=o(x,0);var z=c(x,w[0],[],"06");var y=c(x,w[1],[]);v.oid=KJUR.asn1.ASN1Util.oidHexToInt(z);v.obj=g(y);return v};this.getPolicyQualifierInfo=function(w){var v={};var x=c(w,0,[0],"06");if(x==="2b06010505070201"){var z=l(w,0,[1],"16");v.cps=hextorstr(z)}else{if(x==="2b06010505070202"){var y=a(w,0,[1],"30");v.unotice=this.getUserNotice(y)}}return v};this.getUserNotice=function(z){var w={};var x=o(z,0);for(var y=0;y<x.length;y++){var v=b(z,x[y]);if(v.substr(0,2)!="30"){w.exptext=this.getDisplayText(v)}}return w};this.getDisplayText=function(w){var x={"0c":"utf8","16":"ia5","1a":"vis","1e":"bmp"};var v={};v.type=x[w.substr(0,2)];v.str=hextorstr(h(w,0));return v};this.getExtCRLNumber=function(w,x){var v={extname:"cRLNumber"};if(x){v.critical=true}if(w.substr(0,2)=="02"){v.num={hex:h(w,0)};return v}throw new Error("hExtV parse error: "+w)};this.getExtCRLReason=function(w,x){var v={extname:"cRLReason"};if(x){v.critical=true}if(w.substr(0,2)=="0a"){v.code=parseInt(h(w,0),16);return v}throw new Error("hExtV parse error: "+w)};this.getExtOcspNonce=function(w,y){var v={extname:"ocspNonce"};if(y){v.critical=true}var x=h(w,0);v.hex=x;return v};this.getExtOcspNoCheck=function(w,x){var v={extname:"ocspNoCheck"};if(x){v.critical=true}return v};this.getExtAdobeTimeStamp=function(y,B){if(y===undefined&&B===undefined){var A=this.getExtInfo("adobeTimeStamp");if(A===undefined){return undefined}y=b(this.hex,A.vidx);B=A.critical}var v={extname:"adobeTimeStamp"};if(B){v.critical=true}var x=o(y,0);if(x.length>1){var C=b(y,x[1]);var w=this.getGeneralName(C);if(w.uri!=undefined){v.uri=w.uri}}if(x.length>2){var z=b(y,x[2]);if(z=="0101ff"){v.reqauth=true}if(z=="010100"){v.reqauth=false}}return v};this.getX500NameRule=function(v){var C=true;var G=true;var F=false;var w="";var z="";var I=null;var D=[];for(var y=0;y<v.length;y++){var A=v[y];for(var x=0;x<A.length;x++){D.push(A[x])}}for(var y=0;y<D.length;y++){var H=D[y];var J=H.ds;var E=H.value;var B=H.type;w+=":"+J;if(J!="prn"&&J!="utf8"&&J!="ia5"){return"mixed"}if(J=="ia5"){if(B!="CN"){return"mixed"}else{if(!KJUR.lang.String.isMail(E)){return"mixed"}else{continue}}}if(B=="C"){if(J=="prn"){continue}else{return"mixed"}}z+=":"+J;if(I==null){I=J}else{if(I!==J){return"mixed"}}}if(I==null){return"prn"}else{return I}};this.getX500Name=function(x){var v=this.getX500NameArray(x);var w=this.dnarraytostr(v);return{array:v,str:w}};this.getX500NameArray=function(y){var v=[];var w=o(y,0);for(var x=0;x<w.length;x++){v.push(this.getRDN(b(y,w[x])))}return v};this.getRDN=function(y){var v=[];var w=o(y,0);for(var x=0;x<w.length;x++){v.push(this.getAttrTypeAndValue(b(y,w[x])))}return v};this.getAttrTypeAndValue=function(x){var v={type:null,value:null,ds:null};var w=o(x,0);var A=c(x,w[0],[],"06");var z=c(x,w[1],[]);var y=KJUR.asn1.ASN1Util.oidHexToInt(A);v.type=KJUR.asn1.x509.OID.oid2atype(y);v.ds=this.HEX2STAG[x.substr(w[1],2)];if(v.ds!="bmp"){v.value=hextoutf8(z)}else{v.value=ucs2hextoutf8(z)}return v};this.readCertPEM=function(v){this.readCertHex(s(v))};this.readCertHex=function(v){this.hex=v;this.getVersion();try{i(this.hex,0,[0,7],"a3");this.parseExt()}catch(w){}};this.getParam=function(){var v={};v.version=this.getVersion();v.serial={hex:this.getSerialNumberHex()};v.sigalg=this.getSignatureAlgorithmField();v.issuer=this.getIssuer();v.notbefore=this.getNotBefore();v.notafter=this.getNotAfter();v.subject=this.getSubject();v.sbjpubkey=hextopem(this.getPublicKeyHex(),"PUBLIC KEY");if(this.aExtInfo.length>0){v.ext=this.getExtParamArray()}v.sighex=this.getSignatureValueHex();return v};this.getExtParamArray=function(w){if(w==undefined){var y=e(this.hex,0,[0,"[3]"]);if(y!=-1){w=m(this.hex,0,[0,"[3]",0],"30")}}var v=[];var x=o(w,0);for(var z=0;z<x.length;z++){var B=b(w,x[z]);var A=this.getExtParam(B);if(A!=null){v.push(A)}}return v};this.getExtParam=function(w){var D={};var y=o(w,0);var z=y.length;if(z!=2&&z!=3){throw new Error("wrong number elements in Extension: "+z+" "+w)}var x=n(c(w,0,[0],"06"));var B=false;if(z==3&&a(w,0,[1])=="0101ff"){B=true}var C=a(w,0,[z-1,0]);var A=undefined;if(x=="2.5.29.14"){A=this.getExtSubjectKeyIdentifier(C,B)}else{if(x=="2.5.29.15"){A=this.getExtKeyUsage(C,B)}else{if(x=="2.5.29.17"){A=this.getExtSubjectAltName(C,B)}else{if(x=="2.5.29.18"){A=this.getExtIssuerAltName(C,B)}else{if(x=="2.5.29.19"){A=this.getExtBasicConstraints(C,B)}else{if(x=="2.5.29.31"){A=this.getExtCRLDistributionPoints(C,B)}else{if(x=="2.5.29.32"){A=this.getExtCertificatePolicies(C,B)}else{if(x=="2.5.29.35"){A=this.getExtAuthorityKeyIdentifier(C,B)}else{if(x=="2.5.29.37"){A=this.getExtExtKeyUsage(C,B)}else{if(x=="1.3.6.1.5.5.7.1.1"){A=this.getExtAuthorityInfoAccess(C,B)}else{if(x=="2.5.29.20"){A=this.getExtCRLNumber(C,B)}else{if(x=="2.5.29.21"){A=this.getExtCRLReason(C,B)}else{if(x=="1.3.6.1.5.5.7.48.1.2"){A=this.getExtOcspNonce(C,B)}else{if(x=="1.3.6.1.5.5.7.48.1.5"){A=this.getExtOcspNoCheck(C,B)}else{if(x=="1.2.840.113583.1.1.9.1"){A=this.getExtAdobeTimeStamp(C,B)}}}}}}}}}}}}}}}if(A!=undefined){return A}var v={extname:x,extn:C};if(B){v.critical=true}return v};this.findExt=function(w,x){for(var v=0;v<w.length;v++){if(w[v].extname==x){return w[v]}}return null};this.updateExtCDPFullURI=function(z,v){var y=this.findExt(z,"cRLDistributionPoints");if(y==null){return}if(y.array==undefined){return}var B=y.array;for(var x=0;x<B.length;x++){if(B[x].dpname==undefined){continue}if(B[x].dpname.full==undefined){continue}var C=B[x].dpname.full;for(var w=0;w<C.length;w++){var A=C[x];if(A.uri==undefined){continue}A.uri=v}}};this.updateExtAIAOCSP=function(z,w){var y=this.findExt(z,"authorityInfoAccess");if(y==null){return}if(y.array==undefined){return}var v=y.array;for(var x=0;x<v.length;x++){if(v[x].ocsp!=undefined){v[x].ocsp=w}}};this.updateExtAIACAIssuer=function(z,w){var y=this.findExt(z,"authorityInfoAccess");if(y==null){return}if(y.array==undefined){return}var v=y.array;for(var x=0;x<v.length;x++){if(v[x].caissuer!=undefined){v[x].caissuer=w}}};this.dnarraytostr=function(x){function v(y){return y.map(function(z){return w(z).replace(/\+/,"\\+")}).join("+")}function w(y){return y.type+"="+y.value}return"/"+x.map(function(y){return v(y).replace(/\//,"\\/")}).join("/")};this.getInfo=function(){var w=function(O){var N=JSON.stringify(O.array).replace(/[\[\]\{\}\"]/g,"");return N};var C=function(T){var R="";var N=T.array;for(var Q=0;Q<N.length;Q++){var S=N[Q];R+="    policy oid: "+S.policyoid+"\n";if(S.array===undefined){continue}for(var P=0;P<S.array.length;P++){var O=S.array[P];if(O.cps!==undefined){R+="    cps: "+O.cps+"\n"}}}return R};var F=function(R){var Q="";var N=R.array;for(var P=0;P<N.length;P++){var S=N[P];try{if(S.dpname.full[0].uri!==undefined){Q+="    "+S.dpname.full[0].uri+"\n"}}catch(O){}try{if(S.dname.full[0].dn.hex!==undefined){Q+="    "+X509.hex2dn(S.dpname.full[0].dn.hex)+"\n"}}catch(O){}}return Q};var D=function(R){var Q="";var N=R.array;for(var O=0;O<N.length;O++){var P=N[O];if(P.caissuer!==undefined){Q+="    caissuer: "+P.caissuer+"\n"}if(P.ocsp!==undefined){Q+="    ocsp: "+P.ocsp+"\n"}}return Q};var x=X509;var H,G,M;H="Basic Fields\n";H+="  serial number: "+this.getSerialNumberHex()+"\n";H+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";H+="  issuer: "+this.getIssuerString()+"\n";H+="  notBefore: "+this.getNotBefore()+"\n";H+="  notAfter: "+this.getNotAfter()+"\n";H+="  subject: "+this.getSubjectString()+"\n";H+="  subject public key info: \n";G=this.getPublicKey();H+="    key algorithm: "+G.type+"\n";if(G.type==="RSA"){H+="    n="+hextoposhex(G.n.toString(16)).substr(0,16)+"...\n";H+="    e="+hextoposhex(G.e.toString(16))+"\n"}M=this.aExtInfo;if(M!==undefined&&M!==null){H+="X509v3 Extensions:\n";for(var J=0;J<M.length;J++){var L=M[J];var v=KJUR.asn1.x509.OID.oid2name(L.oid);if(v===""){v=L.oid}var I="";if(L.critical===true){I="CRITICAL"}H+="  "+v+" "+I+":\n";if(v==="basicConstraints"){var y=this.getExtBasicConstraints();if(y.cA===undefined){H+="    {}\n"}else{H+="    cA=true";if(y.pathLen!==undefined){H+=", pathLen="+y.pathLen}H+="\n"}}else{if(v==="keyUsage"){H+="    "+this.getExtKeyUsageString()+"\n"}else{if(v==="subjectKeyIdentifier"){H+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n"}else{if(v==="authorityKeyIdentifier"){var z=this.getExtAuthorityKeyIdentifier();if(z.kid!==undefined){H+="    kid="+z.kid.hex+"\n"}}else{if(v==="extKeyUsage"){var K=this.getExtExtKeyUsage().array;H+="    "+K.join(", ")+"\n"}else{if(v==="subjectAltName"){var A=w(this.getExtSubjectAltName());H+="    "+A+"\n"}else{if(v==="cRLDistributionPoints"){var E=this.getExtCRLDistributionPoints();H+=F(E)}else{if(v==="authorityInfoAccess"){var B=this.getExtAuthorityInfoAccess();H+=D(B)}else{if(v==="certificatePolicies"){H+=C(this.getExtCertificatePolicies())}}}}}}}}}}}H+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n";H+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n";return H};if(typeof r=="string"){if(r.indexOf("-----BEGIN")!=-1){this.readCertPEM(r)}else{if(KJUR.lang.String.isHex(r)){this.readCertHex(r)}}}}X509.hex2dn=function(e,b){if(b===undefined){b=0}var a=new X509();var c=ASN1HEX.getTLV(e,b);var d=a.getX500Name(e);return d.str};X509.hex2rdn=function(f,b){if(b===undefined){b=0}if(f.substr(b,2)!=="31"){throw new Error("malformed RDN")}var c=new Array();var d=ASN1HEX.getChildIdx(f,b);for(var e=0;e<d.length;e++){c.push(X509.hex2attrTypeValue(f,d[e]))}c=c.map(function(a){return a.replace("+","\\+")});return c.join("+")};X509.hex2attrTypeValue=function(d,i){var j=ASN1HEX;var h=j.getV;if(i===undefined){i=0}if(d.substr(i,2)!=="30"){throw new Error("malformed attribute type and value")}var g=j.getChildIdx(d,i);if(g.length!==2||d.substr(g[0],2)!=="06"){"malformed attribute type and value"}var b=h(d,g[0]);var f=KJUR.asn1.ASN1Util.oidHexToInt(b);var e=KJUR.asn1.x509.OID.oid2atype(f);var a=h(d,g[1]);var c=hextorstr(a);return e+"="+c};X509.getPublicKeyFromCertHex=function(b){var a=new X509();a.readCertHex(b);return a.getPublicKey()};X509.getPublicKeyFromCertPEM=function(b){var a=new X509();a.readCertPEM(b);return a.getPublicKey()};X509.getPublicKeyInfoPropOfCertPEM=function(c){var e=ASN1HEX;var g=e.getVbyList;var b={};var a,f,d;b.algparam=null;a=new X509();a.readCertPEM(c);f=a.getPublicKeyHex();b.keyhex=g(f,0,[1],"03").substr(2);b.algoid=g(f,0,[0,0],"06");if(b.algoid==="2a8648ce3d0201"){b.algparam=g(f,0,[0,1],"06")}return b};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];